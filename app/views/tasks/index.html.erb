
<!-- ログインしている場合の処理-->
<% if logged_in? %>
  
  <p>ログイン中のユーザ：<%= current_user.name %></p>
    <!--　タスクの一覧表示 -->
  <div class="row">
    <aside class="col-sm-4">
      <%= form_with(model: @task, local: true) do |f| %>
    
        <div class="form-group"> 
          <%= f.label :status, 'ステータス' %>
          <%= f.text_area :status, class: 'form-control', rows: 1 %>
          <%= f.label :content, 'やること' %>
          <%= f.text_area :content, class: 'form-control', rows: 5 %>
        </div>
        <%= f.submit '保存', class: 'btn btn-primary btn-block' %>
      <% end %>
    </aside>
    
    <div class="col-sm-8">
      <ul class="nav nav-tabs nav-justified mb-3">
        <li class="nav-item"><a href="#" class="nav-link">タスクリスト</a></li>
      </ul>
      <ul class="list-unstyled">
        <% @tasks.each do |task| %>
            <div class="media-body">
              <div>
                <%= link_to task.user.name, user_path(task.user) %> <span class="text-muted">posted at <%= task.created_at %></span>
              </div>
              <div>
                <p class="mb-0">ステータス：<%= task.status %></p>
                <p class="mb-0">やること：<%= task.content %></p>
              </div>
              <div>
                <% if current_user == task.user %>
                  <%= link_to "編集", edit_task_path(task.id), class: 'btn btn-primary btn-sm' %>

                  <%= link_to "削除", task, method: :delete, data: { confirm: "削除しますか?" }, class: 'btn btn-danger btn-sm' %>
                <% end %>
              </div>
            </div>
        <% end %>
        <%= paginate @tasks %>
        </ul>
    </div>
  </div>
  
  
<!-- 未ログインの場合の処理-->
<% else%>
  <div class="center jumbotron">
    <div class="text-center">
      <h1>タスクリストのWebアプリケーション</h1>
      <hr>
      <p><%= link_to 'ログイン認証ページへ', login_path, class: 'btn btn-lg btn-primary' %></p>
  
      <p><%= link_to '新規アカウント作成', signup_path, class: 'btn btn-lg btn-info' %></p>
      
    </div>
  </div>

<% end %>